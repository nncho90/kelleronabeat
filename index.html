<!DOCTYPE html>
<html>
<head>
	<title>Tim Keller on a Beat</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
	<div>
		<h1>Tim Keller on a Beat</h1>
		<button onclick="changeVideos()">Switch Videos</button>
		<br><br>
		<iframe id="sermon" width="560" height="315" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
		<br><br>
		<iframe id="music" width="560" height="315" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
	</div>

	<script>
		var videoIDs = [
			"XtXQF1K3v7Q", // Tim Keller video ID
			"hHW1oY26kxQ" // Lofi music video ID
		];

		var playerVars = {
			"autoplay": 1,
			"controls": 0,
			"showinfo": 0,
			"rel": 0,
			"fs": 0,
			"modestbranding": 1,
			"start": 1
		};

		var sermonPlayer, musicPlayer;

		function onYouTubeIframeAPIReady() {
			sermonPlayer = new YT.Player('sermon', {
				height: '315',
				width: '560',
				videoId: videoIDs[0],
				playerVars: playerVars,
				events: {
					'onReady': onSermonPlayerReady
				}
			});

			musicPlayer = new YT.Player('music', {
				height: '315',
				width: '560',
				videoId: videoIDs[1],
				playerVars: playerVars,
				events: {
					'onReady': onMusicPlayerReady
				}
			});
		}

		function onSermonPlayerReady(event) {
			event.target.setVolume(75);
		}

		function onMusicPlayerReady(event) {
			event.target.setVolume(5);
		}

		function changeVideos() {
			var sermonVideoID, musicVideoID;

			do {
				sermonVideoID = videoIDs[0];
				musicVideoID = videoIDs[1];
				randomizeVideos();
			} while (!isValidVideo(sermonVideoID) || !isValidVideo(musicVideoID));

			sermonPlayer.loadVideoById(sermonVideoID);
			musicPlayer.loadVideoById(musicVideoID);
		}

		function randomizeVideos() {
			videoIDs[0] = getRandomVideoID();
			videoIDs[1] = getRandomVideoID();
		}

		function getRandomVideoID() {
			return videoIDs[Math.floor(Math.random() * videoIDs.length)];
		}

		function isValidVideo(videoID) {
			var isValid = true;

			$.ajax({
				url: "https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=" + videoID + "&format=json",
				type: "GET",
				async: false,
				success: function() {},
				error: function() {
					isValid = false;
				}
			});

			return isValid;
